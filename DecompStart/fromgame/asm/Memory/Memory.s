.include "macros.inc"
.file "Memory.s"

# Combined memory and arena management assembly
.text
.balign 4
.fn ClearArena, local
/* 802686C0 00263AC0  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 802686C4 00263AC4  7C 08 02 A6 */	mflr r0
/* 802686C8 00263AC8  90 01 00 14 */	stw r0, 0x14(r1)
/* 802686CC 00263ACC  93 E1 00 0C */	stw r31, 0xc(r1)
/* 802686D0 00263AD0  93 C1 00 08 */	stw r30, 0x8(r1)
/* 802686D4 00263AD4  48 00 8C 3D */	bl OSGetResetCode
/* 802686D8 00263AD8  54 60 0F FF */	srwi. r0, r3, 31
/* 802686DC 00263ADC  40 82 00 4C */	bne .L_80268728
/* 802686E0 00263AE0  48 00 1D 41 */	bl OSGetArenaHi
/* 802686E4 00263AE4  7C 7F 1B 78 */	mr r31, r3
/* 802686E8 00263AE8  48 00 1D 59 */	bl OSGetMEM1ArenaLo
/* 802686EC 00263AEC  7F E3 F8 50 */	subf r31, r3, r31
/* 802686F0 00263AF0  48 00 1D 51 */	bl OSGetMEM1ArenaLo
/* 802686F4 00263AF4  3C 00 00 04 */	lis r0, 0x4
/* 802686F8 00263AF8  7C 1F 00 40 */	cmplw r31, r0
/* 802686FC 00263AFC  40 81 00 10 */	ble .L_8026870C
/* 80268700 00263B00  3F DF FF FC */	subis r30, r31, 0x4
/* 80268704 00263B04  7F C3 F2 14 */	add r30, r3, r30
/* 80268708 00263B08  48 00 00 08 */	b .L_80268710
.L_8026870C:
/* 8026870C 00263B0C  7C 7E 1B 78 */	mr r30, r3
.L_80268710:
/* 80268710 00263B10  7F E4 FB 78 */	mr r4, r31
/* 80268714 00263B14  48 00 23 6D */	bl DCZeroRange
/* 80268718 00263B18  7F C3 F3 78 */	mr r3, r30
/* 8026871C 00263B1C  3C 80 00 04 */	lis r4, 0x4
/* 80268720 00263B20  48 00 22 D1 */	bl DCFlushRange
/* 80268724 00263B24  48 00 01 60 */	b .L_80268884
.L_80268728:
/* 80268728 00263B28  3F E0 80 65 */	lis r31, __OSRebootParams@ha
/* 8026872C 00263B2C  3B FF DF 40 */	addi r31, r31, __OSRebootParams@l
/* 80268730 00263B30  80 1F 00 0C */	lwz r0, 0xc(r31)
/* 80268734 00263B34  2C 00 00 00 */	cmpwi r0, 0x0
/* 80268738 00263B38  41 82 00 0C */	beq .L_80268744
/* 8026873C 00263B3C  54 00 00 87 */	rlwinm. r0, r0, 0, 2, 3
/* 80268740 00263B40  41 82 00 4C */	beq .L_8026878C
.L_80268744:
/* 80268744 00263B44  48 00 1C DD */	bl OSGetArenaHi
/* 80268748 00263B48  7C 7F 1B 78 */	mr r31, r3
/* 8026874C 00263B4C  48 00 1C F5 */	bl OSGetMEM1ArenaLo
/* 80268750 00263B50  7F E3 F8 50 */	subf r31, r3, r31
/* 80268754 00263B54  48 00 1C ED */	bl OSGetMEM1ArenaLo
/* 80268758 00263B58  3C 00 00 04 */	lis r0, 0x4
/* 8026875C 00263B5C  7C 1F 00 40 */	cmplw r31, r0
/* 80268760 00263B60  40 81 00 10 */	ble .L_80268770
/* 80268764 00263B64  3F DF FF FC */	subis r30, r31, 0x4
/* 80268768 00263B68  7F C3 F2 14 */	add r30, r3, r30
/* 8026876C 00263B6C  48 00 00 08 */	b .L_80268774
.L_80268770:
/* 80268770 00263B70  7C 7E 1B 78 */	mr r30, r3
.L_80268774:
/* 80268774 00263B74  7F E4 FB 78 */	mr r4, r31
/* 80268778 00263B78  48 00 23 09 */	bl DCZeroRange
/* 8026877C 00263B7C  7F C3 F3 78 */	mr r3, r30
/* 80268780 00263B80  3C 80 00 04 */	lis r4, 0x4
/* 80268784 00263B84  48 00 22 6D */	bl DCFlushRange
/* 80268788 00263B88  48 00 00 FC */	b .L_80268884
.L_8026878C:
/* 8026878C 00263B8C  48 00 1C B5 */	bl OSGetMEM1ArenaLo
/* 80268790 00263B90  80 1F 00 0C */	lwz r0, 0xc(r31)
/* 80268794 00263B94  7C 03 00 40 */	cmplw r3, r0
/* 80268798 00263B98  40 80 00 EC */	bge .L_80268884
/* 8026879C 00263B9C  48 00 1C 85 */	bl OSGetArenaHi
/* 802687A0 00263BA0  80 1F 00 0C */	lwz r0, 0xc(r31)
/* 802687A4 00263BA4  7C 03 00 40 */	cmplw r3, r0
/* 802687A8 00263BA8  41 81 00 4C */	bgt .L_802687F4
/* 802687AC 00263BAC  48 00 1C 75 */	bl OSGetArenaHi
/* 802687B0 00263BB0  7C 7F 1B 78 */	mr r31, r3
/* 802687B4 00263BB4  48 00 1C 8D */	bl OSGetMEM1ArenaLo
/* 802687B8 00263BB8  7F E3 F8 50 */	subf r31, r3, r31
/* 802687BC 00263BBC  48 00 1C 85 */	bl OSGetMEM1ArenaLo
/* 802687C0 00263BC0  3C 00 00 04 */	lis r0, 0x4
/* 802687C4 00263BC4  7C 1F 00 40 */	cmplw r31, r0
/* 802687C8 00263BC8  40 81 00 10 */	ble .L_802687D8
/* 802687CC 00263BCC  3F DF FF FC */	subis r30, r31, 0x4
/* 802687D0 00263BD0  7F C3 F2 14 */	add r30, r3, r30
/* 802687D4 00263BD4  48 00 00 08 */	b .L_802687DC
.L_802687D8:
/* 802687D8 00263BD8  7C 7E 1B 78 */	mr r30, r3
.L_802687DC:
/* 802687DC 00263BDC  7F E4 FB 78 */	mr r4, r31
/* 802687E0 00263BE0  48 00 22 A1 */	bl DCZeroRange
/* 802687E4 00263BE4  7F C3 F3 78 */	mr r3, r30
/* 802687E8 00263BE8  3C 80 00 04 */	lis r4, 0x4
/* 802687EC 00263BEC  48 00 22 05 */	bl DCFlushRange
/* 802687F0 00263BF0  48 00 00 94 */	b .L_80268884
.L_802687F4:
/* 802687F4 00263BF4  48 00 1C 4D */	bl OSGetMEM1ArenaLo
/* 802687F8 00263BF8  80 1F 00 0C */	lwz r0, 0xc(r31)
/* 802687FC 00263BFC  7F E3 00 50 */	subf r31, r3, r0
/* 80268800 00263C00  48 00 1C 41 */	bl OSGetMEM1ArenaLo
/* 80268804 00263C04  3C 00 00 04 */	lis r0, 0x4
/* 80268808 00263C08  7C 1F 00 40 */	cmplw r31, r0
/* 8026880C 00263C0C  40 81 00 10 */	ble .L_8026881C
/* 80268810 00263C10  3F DF FF FC */	subis r30, r31, 0x4
/* 80268814 00263C14  7F C3 F2 14 */	add r30, r3, r30
/* 80268818 00263C18  48 00 00 08 */	b .L_80268820
.L_8026881C:
/* 8026881C 00263C1C  7C 7E 1B 78 */	mr r30, r3
.L_80268820:
/* 80268820 00263C20  7F E4 FB 78 */	mr r4, r31
/* 80268824 00263C24  48 00 22 5D */	bl DCZeroRange
/* 80268828 00263C28  7F C3 F3 78 */	mr r3, r30
/* 8026882C 00263C2C  3C 80 00 04 */	lis r4, 0x4
/* 80268830 00263C30  48 00 21 C1 */	bl DCFlushRange
/* 80268834 00263C34  3C 60 80 65 */	lis r3, __OSRebootParams@ha
/* 80268838 00263C38  38 63 DF 40 */	addi r3, r3, __OSRebootParams@l
/* 8026883C 00263C3C  83 E3 00 10 */	lwz r31, 0x10(r3)
/* 80268840 00263C40  48 00 1B E1 */	bl OSGetArenaHi
/* 80268844 00263C44  7C 03 F8 40 */	cmplw r3, r31
/* 80268848 00263C48  40 81 00 3C */	ble .L_80268884
/* 8026884C 00263C4C  48 00 1B D5 */	bl OSGetArenaHi
/* 80268850 00263C50  7C 9F 18 50 */	subf r4, r31, r3
/* 80268854 00263C54  3C 00 00 04 */	lis r0, 0x4
/* 80268858 00263C58  7C 04 00 40 */	cmplw r4, r0
/* 8026885C 00263C5C  40 81 00 10 */	ble .L_8026886C
/* 80268860 00263C60  3F C4 FF FC */	subis r30, r4, 0x4
/* 80268864 00263C64  7F DF F2 14 */	add r30, r31, r30
/* 80268868 00263C68  48 00 00 08 */	b .L_80268870
.L_8026886C:
/* 8026886C 00263C6C  7F FE FB 78 */	mr r30, r31
.L_80268870:
/* 80268870 00263C70  7F E3 FB 78 */	mr r3, r31
/* 80268874 00263C74  48 00 22 0D */	bl DCZeroRange
/* 80268878 00263C78  7F C3 F3 78 */	mr r3, r30
/* 8026887C 00263C7C  3C 80 00 04 */	lis r4, 0x4
/* 80268880 00263C80  48 00 21 71 */	bl DCFlushRange
.L_80268884:
/* 80268884 00263C84  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80268888 00263C88  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 8026888C 00263C8C  83 C1 00 08 */	lwz r30, 0x8(r1)
/* 80268890 00263C90  7C 08 03 A6 */	mtlr r0
/* 80268894 00263C94  38 21 00 10 */	addi r1, r1, 0x10
/* 80268898 00263C98  4E 80 00 20 */	blr
.endfn ClearArena

.fn ClearMEM2Arena, local
/* 802688A0 00263CA0  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 802688A4 00263CA4  7C 08 02 A6 */	mflr r0
/* 802688A8 00263CA8  90 01 00 14 */	stw r0, 0x14(r1)
/* 802688AC 00263CAC  93 E1 00 0C */	stw r31, 0xc(r1)
/* 802688B0 00263CB0  93 C1 00 08 */	stw r30, 0x8(r1)
/* 802688B4 00263CB4  48 00 8A 5D */	bl OSGetResetCode
/* 802688B8 00263CB8  54 60 0F FF */	srwi. r0, r3, 31
/* 802688BC 00263CBC  40 82 00 4C */	bne .L_80268908
/* 802688C0 00263CC0  48 00 1B 71 */	bl OSGetMEM2ArenaHi
/* 802688C4 00263CC4  7C 7F 1B 78 */	mr r31, r3
/* 802688C8 00263CC8  48 00 1B 89 */	bl OSGetMEM2ArenaLo
/* 802688CC 00263CCC  7F E3 F8 50 */	subf r31, r3, r31
/* 802688D0 00263CD0  48 00 1B 81 */	bl OSGetMEM2ArenaLo
/* 802688D4 00263CD4  3C 00 00 04 */	lis r0, 0x4
/* 802688D8 00263CD8  7C 1F 00 40 */	cmplw r31, r0
/* 802688DC 00263CDC  40 81 00 10 */	ble .L_802688EC
/* 802688E0 00263CE0  3F DF FF FC */	subis r30, r31, 0x4
/* 802688E4 00263CE4  7F C3 F2 14 */	add r30, r3, r30
/* 802688E8 00263CE8  48 00 00 08 */	b .L_802688F0
.L_802688EC:
/* 802688EC 00263CEC  7C 7E 1B 78 */	mr r30, r3
.L_802688F0:
/* 802688F0 00263CF0  7F E4 FB 78 */	mr r4, r31
/* 802688F4 00263CF4  48 00 21 8D */	bl DCZeroRange
/* 802688F8 00263CF8  7F C3 F3 78 */	mr r3, r30
/* 802688FC 00263CFC  3C 80 00 04 */	lis r4, 0x4
/* 80268900 00263D00  48 00 20 F1 */	bl DCFlushRange
/* 80268904 00263D04  48 00 01 68 */	b .L_80268A6C
.L_80268908:
/* 80268908 00263D08  3F E0 80 65 */	lis r31, __OSRebootParams@ha
/* 8026890C 00263D0C  3B FF DF 40 */	addi r31, r31, __OSRebootParams@l
/* 80268910 00263D10  80 1F 00 0C */	lwz r0, 0xc(r31)
/* 80268914 00263D14  2C 00 00 00 */	cmpwi r0, 0x0
/* 80268918 00263D18  41 82 00 14 */	beq .L_8026892C
/* 8026891C 00263D1C  54 03 00 86 */	rlwinm r3, r0, 0, 2, 3
/* 80268920 00263D20  3C 03 F0 00 */	subis r0, r3, 0x1000
/* 80268924 00263D24  28 00 00 00 */	cmplwi r0, 0x0
/* 80268928 00263D28  41 82 00 4C */	beq .L_80268974
.L_8026892C:
/* 8026892C 00263D2C  48 00 1B 05 */	bl OSGetMEM2ArenaHi
/* 80268930 00263D30  7C 7F 1B 78 */	mr r31, r3
/* 80268934 00263D34  48 00 1B 1D */	bl OSGetMEM2ArenaLo
/* 80268938 00263D38  7F E3 F8 50 */	subf r31, r3, r31
/* 8026893C 00263D3C  48 00 1B 15 */	bl OSGetMEM2ArenaLo
/* 80268940 00263D40  3C 00 00 04 */	lis r0, 0x4
/* 80268944 00263D44  7C 1F 00 40 */	cmplw r31, r0
/* 80268948 00263D48  40 81 00 10 */	ble .L_80268958
/* 8026894C 00263D4C  3F DF FF FC */	subis r30, r31, 0x4
/* 80268950 00263D50  7F C3 F2 14 */	add r30, r3, r30
/* 80268954 00263D54  48 00 00 08 */	b .L_8026895C
.L_80268958:
/* 80268958 00263D58  7C 7E 1B 78 */	mr r30, r3
.L_8026895C:
/* 8026895C 00263D5C  7F E4 FB 78 */	mr r4, r31
/* 80268960 00263D60  48 00 21 21 */	bl DCZeroRange
/* 80268964 00263D64  7F C3 F3 78 */	mr r3, r30
/* 80268968 00263D68  3C 80 00 04 */	lis r4, 0x4
/* 8026896C 00263D6C  48 00 20 85 */	bl DCFlushRange
/* 80268970 00263D70  48 00 00 FC */	b .L_80268A6C
.L_80268974:
/* 80268974 00263D74  48 00 1A DD */	bl OSGetMEM2ArenaLo
/* 80268978 00263D78  80 1F 00 0C */	lwz r0, 0xc(r31)
/* 8026897C 00263D7C  7C 03 00 40 */	cmplw r3, r0
/* 80268980 00263D80  40 80 00 EC */	bge .L_80268A6C
/* 80268984 00263D84  48 00 1A AD */	bl OSGetMEM2ArenaHi
/* 80268988 00263D88  80 1F 00 0C */	lwz r0, 0xc(r31)
/* 8026898C 00263D8C  7C 03 00 40 */	cmplw r3, r0
/* 80268990 00263D90  41 81 00 4C */	bgt .L_802689DC
/* 80268994 00263D94  48 00 1A 9D */	bl OSGetMEM2ArenaHi
/* 80268998 00263D98  7C 7F 1B 78 */	mr r31, r3
/* 8026899C 00263D9C  48 00 1A B5 */	bl OSGetMEM2ArenaLo
/* 802689A0 00263DA0  7F E3 F8 50 */	subf r31, r3, r31
/* 802689A4 00263DA4  48 00 1A AD */	bl OSGetMEM2ArenaLo
/* 802689A8 00263DA8  3C 00 00 04 */	lis r0, 0x4
/* 802689AC 00263DAC  7C 1F 00 40 */	cmplw r31, r0
/* 802689B0 00263DB0  40 81 00 10 */	ble .L_802689C0
/* 802689B4 00263DB4  3F DF FF FC */	subis r30, r31, 0x4
/* 802689B8 00263DB8  7F C3 F2 14 */	add r30, r3, r30
/* 802689BC 00263DBC  48 00 00 08 */	b .L_802689C4
.L_802689C0:
/* 802689C0 00263DC0  7C 7E 1B 78 */	mr r30, r3
.L_802689C4:
/* 802689C4 00263DC4  7F E4 FB 78 */	mr r4, r31
/* 802689C8 00263DC8  48 00 20 B9 */	bl DCZeroRange
/* 802689CC 00263DCC  7F C3 F3 78 */	mr r3, r30
/* 802689D0 00263DD0  3C 80 00 04 */	lis r4, 0x4
/* 802689D4 00263DD4  48 00 20 1D */	bl DCFlushRange
/* 802689D8 00263DD8  48 00 00 94 */	b .L_80268A6C
.L_802689DC:
/* 802689DC 00263DDC  48 00 1A 75 */	bl OSGetMEM2ArenaLo
/* 802689E0 00263DE0  80 1F 00 0C */	lwz r0, 0xc(r31)
/* 802689E4 00263DE4  7F E3 00 50 */	subf r31, r3, r0
/* 802689E8 00263DE8  48 00 1A 69 */	bl OSGetMEM2ArenaLo
/* 802689EC 00263DEC  3C 00 00 04 */	lis r0, 0x4
/* 802689F0 00263DF0  7C 1F 00 40 */	cmplw r31, r0
/* 802689F4 00263DF4  40 81 00 10 */	ble .L_80268A04
/* 802689F8 00263DF8  3F DF FF FC */	subis r30, r31, 0x4
/* 802689FC 00263DFC  7F C3 F2 14 */	add r30, r3, r30
/* 80268A00 00263E00  48 00 00 08 */	b .L_80268A08
.L_80268A04:
/* 80268A04 00263E04  7C 7E 1B 78 */	mr r30, r3
.L_80268A08:
/* 80268A08 00263E08  7F E4 FB 78 */	mr r4, r31
/* 80268A0C 00263E0C  48 00 20 75 */	bl DCZeroRange
/* 80268A10 00263E10  7F C3 F3 78 */	mr r3, r30
/* 80268A14 00263E14  3C 80 00 04 */	lis r4, 0x4
/* 80268A18 00263E18  48 00 1F D9 */	bl DCFlushRange
/* 80268A1C 00263E1C  3C 60 80 65 */	lis r3, __OSRebootParams@ha
/* 80268A20 00263E20  38 63 DF 40 */	addi r3, r3, __OSRebootParams@l
/* 80268A24 00263E24  83 E3 00 10 */	lwz r31, 0x10(r3)
/* 80268A28 00263E28  48 00 1A 09 */	bl OSGetMEM2ArenaHi
/* 80268A2C 00263E2C  7C 03 F8 40 */	cmplw r3, r31
/* 80268A30 00263E30  40 81 00 3C */	ble .L_80268A6C
/* 80268A34 00263E34  48 00 19 FD */	bl OSGetMEM2ArenaHi
/* 80268A38 00263E38  7C 9F 18 50 */	subf r4, r31, r3
/* 80268A3C 00263E3C  3C 00 00 04 */	lis r0, 0x4
/* 80268A40 00263E40  7C 04 00 40 */	cmplw r4, r0
/* 80268A44 00263E44  40 81 00 10 */	ble .L_80268A54
/* 80268A48 00263E48  3F C4 FF FC */	subis r30, r4, 0x4
/* 80268A4C 00263E4C  7F DF F2 14 */	add r30, r31, r30
/* 80268A50 00263E50  48 00 00 08 */	b .L_80268A58
.L_80268A54:
/* 80268A54 00263E54  7F FE FB 78 */	mr r30, r31
.L_80268A58:
/* 80268A58 00263E58  7F E3 FB 78 */	mr r3, r31
/* 80268A5C 00263E5C  48 00 20 25 */	bl DCZeroRange
/* 80268A60 00263E60  7F C3 F3 78 */	mr r3, r30
/* 80268A64 00263E64  3C 80 00 04 */	lis r4, 0x4
/* 80268A68 00263E68  48 00 1F 89 */	bl DCFlushRange
.L_80268A6C:
/* 80268A6C 00263E6C  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80268A70 00263E70  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 80268A74 00263E74  83 C1 00 08 */	lwz r30, 0x8(r1)
/* 80268A78 00263E78  7C 08 03 A6 */	mtlr r0
/* 80268A7C 00263E7C  38 21 00 10 */	addi r1, r1, 0x10
/* 80268A80 00263E80  4E 80 00 20 */	blr
.endfn ClearMEM2Arena

.fn MEMIntrruptHandler, local
/* 8026FE50 0026B250  3D 00 CC 00 */	lis r8, 0xcc00
/* 8026FE54 0026B254  3C 60 80 65 */	lis r3, __OSErrorTable@ha
/* 8026FE58 0026B258  A0 A8 40 1E */	lhz r5, 0x401e(r8)
/* 8026FE5C 0026B25C  38 00 00 00 */	li r0, 0x0
/* 8026FE60 0026B260  A0 E8 40 24 */	lhz r7, 0x4024(r8)
/* 8026FE64 0026B264  38 63 DF B0 */	addi r3, r3, __OSErrorTable@l
/* 8026FE68 0026B268  A0 C8 40 22 */	lhz r6, 0x4022(r8)
/* 8026FE6C 0026B26C  50 E6 81 9E */	rlwimi r6, r7, 16, 6, 15
/* 8026FE70 0026B270  B0 08 40 20 */	sth r0, 0x4020(r8)
/* 8026FE74 0026B274  81 83 00 3C */	lwz r12, 0x3c(r3)
/* 8026FE78 0026B278  2C 0C 00 00 */	cmpwi r12, 0x0
/* 8026FE7C 0026B27C  41 82 00 14 */	beq .L_8026FE90
/* 8026FE80 0026B280  38 60 00 0F */	li r3, 0xf
/* 8026FE84 0026B284  4C C6 31 82 */	crclr cr1eq
/* 8026FE88 0026B288  7D 89 03 A6 */	mtctr r12
/* 8026FE8C 0026B28C  4E 80 04 20 */	bctr
.L_8026FE90:
/* 8026FE90 0026B290  38 60 00 0F */	li r3, 0xf
/* 8026FE94 0026B294  4B FF BE EC */	b __OSUnhandledException
.endfn MEMIntrruptHandler

